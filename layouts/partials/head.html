<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<!-- 页面标题 -->
<title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} - {{ .Site.Title }}{{ end }}</title>

<!-- 页面描述 -->
<meta name="description" content="{{ if .IsHome }}{{ .Site.Params.description }}{{ else if .Description }}{{ .Description }}{{ else }}{{ .Summary | plainify }}{{ end }}">

<!-- SEO元标签 -->
<meta name="keywords" content="{{ if .Params.keywords }}{{ .Params.keywords }}{{ else }}{{ .Site.Params.keywords }}{{ end }}">
<meta name="author" content="{{ if .Params.author }}{{ .Params.author }}{{ else }}{{ .Site.Params.author }}{{ end }}">

<!-- Open Graph标签 -->
<meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} - {{ .Site.Title }}{{ end }}">
<meta property="og:description" content="{{ if .IsHome }}{{ .Site.Params.description }}{{ else if .Description }}{{ .Description }}{{ else }}{{ .Summary | plainify }}{{ end }}">
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
{{ if .Params.featuredImage }}
<meta property="og:image" content="{{ .Params.featuredImage | absURL }}">
{{ else if .Site.Params.defaultFeaturedImage }}
<meta property="og:image" content="{{ .Site.Params.defaultFeaturedImage | absURL }}">
{{ end }}

<!-- Twitter Card标签 -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} - {{ .Site.Title }}{{ end }}">
<meta name="twitter:description" content="{{ if .IsHome }}{{ .Site.Params.description }}{{ else if .Description }}{{ .Description }}{{ else }}{{ .Summary | plainify }}{{ end }}">
{{ if .Params.featuredImage }}
<meta name="twitter:image" content="{{ .Params.featuredImage | absURL }}">
{{ else if .Site.Params.defaultFeaturedImage }}
<meta name="twitter:image" content="{{ .Site.Params.defaultFeaturedImage | absURL }}">
{{ end }}

<!-- Bootstrap 5.3 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<!-- 图标库 Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- 代码高亮样式 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" id="prism-light-theme">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" id="prism-dark-theme" disabled>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">

<!-- KaTeX样式 -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">

<!-- KaTeX脚本 -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script>

<!-- 主样式文件 -->
{{ $css := resources.Get "css/main.css" | minify | fingerprint }}
<link rel="stylesheet" href="{{ $css.RelPermalink }}">

<!-- 网站图标 -->
<link rel="icon" href="{{ "favicon.ico" | absURL }}" type="image/x-icon">
<link rel="apple-touch-icon" href="{{ "apple-touch-icon.png" | absURL }}">

<!-- 主题变量和基础样式 -->
<style>
    :root {
        --bs-primary: #0d6efd;
        --bs-primary-rgb: 13, 110, 253;
        --bg-color: #f8f9fa;
        --text-color: #212529;
        --secondary-color: #6c757d;
        --border-color: #dee2e6;
        --card-bg: #ffffff;
        --hover-color: #0b5ed7;
        --code-bg: #f6f8fa;
        --navbar-height: 56px;
    }
    
    [data-bs-theme="dark"] {
        --bg-color: #1a1a2e;
        --text-color: #e0e0e0;
        --secondary-color: #adb5bd;
        --border-color: #343a40;
        --card-bg: #212529;
        --hover-color: #3d8bfd;
        --code-bg: #2d3748;
    }
    
    body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        transition: background-color 0.3s, color 0.3s;
    }
    
    /* 亮色模式文字颜色修复 */
    .text-muted { color: var(--secondary-color) !important; }
    .card-title a, .card-text, p, span, li { color: var(--text-color); }
    .badge.bg-secondary { color: #fff !important; }
    a { color: var(--bs-primary); }
    
    /* 滚动条样式 */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }
    
    ::-webkit-scrollbar-track {
        background: var(--border-color);
    }
    
    ::-webkit-scrollbar-thumb {
        background: var(--secondary-color);
        border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: var(--bs-primary);
    }
    
    /* 平滑滚动 */
    html {
        scroll-behavior: smooth;
        scroll-padding-top: calc(var(--navbar-height) + 20px);
    }
    
    /* 强制去除所有代码块边框 */
    pre, code, pre[class*="language-"], code[class*="language-"],
    .highlight, .highlight pre, div[class*="highlight"] {
        border: none !important;
        outline: none !important;
        box-shadow: none !important;
    }
    
    /* 暗色模式下强制去除代码块边框 */
    [data-bs-theme="dark"] pre,
    [data-bs-theme="dark"] code,
    [data-bs-theme="dark"] pre[class*="language-"],
    [data-bs-theme="dark"] code[class*="language-"],
    [data-bs-theme="dark"] .highlight,
    [data-bs-theme="dark"] .highlight pre,
    [data-bs-theme="dark"] div[class*="highlight"] {
        border: none !important;
        outline: none !important;
        box-shadow: none !important;
    }
</style>

<!-- 暗黑模式检测 -->
<script>
    (function() {
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            document.documentElement.setAttribute('data-bs-theme', 'dark');
        }
        
        // 切换代码高亮主题
        function switchCodeTheme(theme) {
            const lightTheme = document.getElementById('prism-light-theme');
            const darkTheme = document.getElementById('prism-dark-theme');
            
            if (theme === 'dark') {
                if (lightTheme) lightTheme.disabled = true;
                if (darkTheme) darkTheme.disabled = false;
            } else {
                if (lightTheme) lightTheme.disabled = false;
                if (darkTheme) darkTheme.disabled = true;
            }
        }
        
        switchCodeTheme(savedTheme === 'dark' || (!savedTheme && prefersDark) ? 'dark' : 'light');
    })();
</script>
